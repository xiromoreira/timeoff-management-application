
{{> header }}

<h1>Auth authentication</h1>

<p class="lead">Auth authentication details</p>

{{> show_flash_messages }}

<div class="row main-row_header">
  <p class="col-md-12">Configuration</p>
</div>

<div class="row">

  <div class="col-md-12">

    <form class="form-horizontal" action="" method="post">

      <div class="form-group">
        <div class="col-md-9 col-md-offset-3">
        <label for="local_auth_enabled" class="control-label">
          <input
            id="local_auth_enabled"
            type="checkbox"
            {{# if local_config }} checked="checked" {{/if}}
            name="local_auth_enabled"
           />&nbsp;
           Enable local password
          </label>
        </div>
      </div>

      <div class="form-group">
        <div class="col-md-9 col-md-offset-3">
        <label for="ldap_auth_enabled" class="control-label">
          <input
            id="ldap_auth_enabled"
            type="checkbox"
            {{# if ldap_config }} checked="checked" {{/if}}
            name="ldap_auth_enabled"
           />&nbsp;
           Enable LDAP authentication
          </label>
        </div>
      </div>

      <div class="form-group">
        <div class="col-md-9 col-md-offset-3">
        <label for="imap_auth_enabled" class="control-label">
          <input
            id="imap_auth_enabled"
            type="checkbox"
            {{# if imap_config }} checked="checked" {{/if}}
            name="imap_auth_enabled"
           />&nbsp;
           Enable IMAP authentication
          </label>
        </div>
      </div>

      <hr/>
      <div class="form-group">
          <label for="auth_domain" class="col-md-3 control-label">Org users domain</label>
          <div class="col-md-5">
            <input class="form-control" id="auth_domain" placeholder="" name="auth_domain" value="{{ auth_domain }}" aria-describedby="auth_domain_help">
          </div>
          <span id="auth_domain_help" class="help-block">Domain used to link email address with this company and try the auth methods set here</span>
        </div>

      <hr/>

      <div id="ldap_config">
        <div class="form-group">
          <label for="ldap_url" class="col-md-3 control-label">URL to LDAP server</label>
          <div class="col-md-5">
            <input class="form-control" id="ldap_url" placeholder="ldap://ldap.forumsys.com:389" name="url" value="{{ldap_config.url}}" aria-describedby="ldap_url_help" >
          </div>
          <span id="ldap_url_help" class="help-block">The URL must contain the protocol and port parts</span>
          <div class="col-md-9 col-md-offset-3">
            <label for="allow_unauthorized_cert" class="control-label">
              <input
                id="allow_unauthorized_cert"
                type="checkbox"
                {{# if ldap_config.allow_unauthorized_cert }} checked="checked" {{/if}}
                name="allow_unauthorized_cert"
              />&nbsp;
              Allow unauthorized SSL certificate (if LDAPS is used)
            </label>
          </div>
        </div>

        <div class="form-group">
          <label for="ldap_bindn" class="col-md-3 control-label">BindDN</label>
          <div class="col-md-5">
            <input class="form-control" id="ldap_bindn" placeholder="cn=read-only-admin,dc=example,dc=com" name="binddn" value="{{ ldap_config.binddn }}">
          </div>
        </div>

        <div class="form-group">
          <label for="ldap_password" class="col-md-3 control-label">Bind Credentials</label>
          <div class="col-md-5">
            <input class="form-control" id="ldap_password" placeholder="" name="bindcredentials" value="{{ ldap_config.bindcredentials }}" type="password" aria-describedby="ldap_password_help">
          </div>
          <span id="ldap_password_help" class="help-block">Password used for dealing with LDAP queries</span>
        </div>

        <div class="form-group">
          <label for="ldap_search_base" class="col-md-3 control-label">Search Base</label>
          <div class="col-md-5">
            <input class="form-control" id="ldap_search_base" placeholder="dc=example,dc=com" name="searchbase" value="{{ ldap_config.searchbase }}">
          </div>
        </div>
      </div>

      <div id="imap_config">
        <div class="form-group">
          <label for="imap_host" class="col-md-3 control-label">IMAP host</label>
          <div class="col-md-5">
            <input class="form-control" id="imap_host" placeholder="127.0.0.1" name="imap_host" value="{{imap_config.host}}">
          </div>
        </div>

        <div class="form-group">
          <label for="imap_port" class="col-md-3 control-label">IMAP port</label>
          <div class="col-md-5">
            <input class="form-control" id="imap_port" placeholder="993" name="imap_port" value="{{imap_config.port}}">
          </div>
        </div>

        <div class="form-group">
          <label for="imap_security" class="col-md-3 control-label">Security</label>
          <div class="col-md-5">
            <select class="form-control" id="imap_security" name="imap_security">
              <option value="" {{# if_equal imap_config.security "" }} selected="selected"{{/if_equal}}>None</option>
              <option value="tls" {{# if_equal imap_config.security "tls" }} selected="selected"{{/if_equal}}>TLS</option>
              <option value="starttls" {{# if_equal imap_config.security "starttls" }} selected="selected"{{/if_equal}}>STARTTLS</option>
            </select>
          </div>
        </div>
      </div>

      <div class="form-group">
        <div class="col-md-offset-3 col-md-5">
          <button id="submit_registration" type="submit" class="pull-right btn btn-success single-click">Save auth configuration</button>
        </div>
      </div>

    </form>


  </div>

</div>


{{> footer }}
